name: Community-Issue
on:
  issues:
    types: [opened]
jobs:
  community:
    runs-on: ubuntu-latest
    steps:
      - name: Is Longhorn Member
        uses: tspascoal/get-user-teams-membership@v1.0.4
        id: is-longhorn-member
        with:
          username: ${{ github.event.issue.user.login }}
          organization: yyz-field
          GITHUB_TOKEN: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
      - name: Add To Community Project
        if: fromJSON(steps.is-longhorn-member.outputs.teams)[0] == null
        uses: actions/add-to-project@v0.3.0
        id: add-to-community-project
        with:
          project-url: https://github.com/orgs/yyz-field/projects/1
          github-token: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
      - name: Update Status To New
        uses: kalgurn/update-project-item-status@main
        with:
          project-url: https://github.com/orgs/yyz-field/projects/1
          github-token: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
          item-id: ${{ steps.add-to-community-project.outputs.itemId }}
          status: New
