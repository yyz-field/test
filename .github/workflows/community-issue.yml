name: Community-Issue
on:
  issues:
    types: [opened]
jobs:
  community:
    runs-on: ubuntu-latest
    steps:
      - name: Is Longhorn Member
        uses: tspascoal/get-user-teams-membership@v1.0.4
        id: is-longhorn-member
        with:
          username: ${{ github.event.issue.user.login }}
          organization: yyz-field
          GITHUB_TOKEN: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
      - name: Add To Community Project
        if: fromJSON(steps.is-longhorn-member.outputs.teams)[0] == null
        uses: actions/add-to-project@v0.3.0
        with:
          project-url: https://github.com/orgs/yyz-field/projects/1
          github-token: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
      - name: Update Status To New
        if: fromJSON(steps.is-longhorn-member.outputs.teams)[0] == null
        uses: docker://takanabe/github-actions-automate-projects:v0.0.1
        env:
          GITHUB_TOKEN: ${{ secrets.CUSTOM_GITHUB_TOKEN }}
          GITHUB_PROJECT_URL: https://github.com/orgs/yyz-field/projects/1
          GITHUB_PROJECT_COLUMN_NAME: New
